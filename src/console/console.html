<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Isekai Console</title>
    <link rel="icon" type="image/png" href="../assets/favicon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Geist+Mono:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../shared/theme.css" />
    <link rel="stylesheet" href="./console.css" />
  </head>
  <body>
    <div class="console-container">
      <!-- Header -->
      <header class="console-header">
        <div class="header-left">
          <img src="../assets/logo.svg" alt="Isekai" class="logo" />
        </div>
        <div class="header-right">
          <div class="status-indicators">
            <div id="status-indicator" class="status-indicator stopped">
              <span class="status-dot"></span>
              <span id="status-text">Stopped</span>
            </div>
            <div class="status-separator"></div>
            <div id="api-status-indicator" class="status-indicator stopped">
              <span class="status-dot"></span>
              <span id="api-status-text">Checking</span>
            </div>
          </div>
          <a href="https://github.com/isekai-sh/isekai-chrome-extension" target="_blank" rel="noopener noreferrer" class="github-link" title="View on GitHub">
            <i data-lucide="github"></i>
          </a>
        </div>
      </header>

      <!-- Toolbar -->
      <div class="console-toolbar">
        <div class="toolbar-left">
          <!-- Log limit selector -->
          <select id="log-limit" class="log-limit-select">
            <option value="100">100</option>
            <option value="200">200</option>
            <option value="500">500</option>
            <option value="1000" selected>1000</option>
            <option value="-1">All</option>
          </select>

          <!-- Log level filters -->
          <div class="filter-group">
            <label class="filter-checkbox">
              <input type="checkbox" id="filter-debug" checked />
              <span class="filter-label">DEBUG</span>
            </label>
            <label class="filter-checkbox">
              <input type="checkbox" id="filter-info" checked />
              <span class="filter-label">INFO</span>
            </label>
            <label class="filter-checkbox">
              <input type="checkbox" id="filter-success" checked />
              <span class="filter-label">SUCCESS</span>
            </label>
            <label class="filter-checkbox">
              <input type="checkbox" id="filter-warning" checked />
              <span class="filter-label">WARNING</span>
            </label>
            <label class="filter-checkbox">
              <input type="checkbox" id="filter-error" checked />
              <span class="filter-label">ERROR</span>
            </label>
          </div>

          <!-- Auto-scroll toggle -->
          <label class="auto-scroll-toggle">
            <input type="checkbox" id="auto-scroll" checked />
            <span>SCROLL</span>
          </label>
        </div>

        <div class="toolbar-right">
          <button id="reset-stuck-btn" class="btn-secondary btn-small btn-with-icon">
            <i data-lucide="rotate-ccw"></i>
            <span>Reset Stuck</span>
          </button>
          <button id="cancel-all-btn" class="btn-secondary btn-small btn-with-icon">
            <i data-lucide="x-circle"></i>
            <span>Cancel All</span>
          </button>
          <button id="export-btn" class="btn-secondary btn-small btn-with-icon">
            <i data-lucide="download"></i>
            <span>Export</span>
          </button>
          <button id="copy-btn" class="btn-secondary btn-small btn-with-icon">
            <i data-lucide="copy"></i>
            <span>Copy</span>
          </button>
          <button id="clear-btn" class="btn-secondary btn-small btn-with-icon">
            <i data-lucide="trash-2"></i>
            <span>Clear</span>
          </button>
          <button id="settings-btn" class="btn-secondary btn-small btn-with-icon">
            <i data-lucide="settings"></i>
            <span>Settings</span>
          </button>
          <button id="toggle-btn" class="btn-primary btn-small btn-with-icon" disabled>
            <span class="btn-icon-wrapper">
              <i data-lucide="play" class="icon-play"></i>
              <i data-lucide="stop-circle" class="icon-stop" style="display: none;"></i>
            </span>
            <span id="toggle-btn-text">Start</span>
          </button>
        </div>
      </div>

      <!-- Main content (two columns) -->
      <div class="main-content">
        <!-- Left: Log output -->
        <div class="log-container" id="log-container">
          <div class="log-output" id="log-output">
            <div class="log-entry info">
              <span class="log-timestamp">[--:--:--]</span>
              <span class="log-level">ℹ️ INFO</span>
              <span class="log-message">Waiting for logs...</span>
            </div>
          </div>
        </div>

        <!-- Right: Job history -->
        <div class="job-history" id="job-history">
          <div class="job-list" id="job-list">
            <div class="job-empty">No jobs processed yet</div>
          </div>
        </div>
      </div>

      <!-- Stats status bar -->
      <div class="stats-panel" id="stats-panel">
        <div class="stats-content" id="stats-content">
          <div class="stat-item">
            <span class="stat-label">Pending:</span>
            <span class="stat-value" id="stat-pending">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Processing:</span>
            <span class="stat-value" id="stat-processing">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Processed:</span>
            <span class="stat-value" id="stat-processed">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Succeeded:</span>
            <span class="stat-value" id="stat-succeeded">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Failed:</span>
            <span class="stat-value" id="stat-failed">0</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal" style="display: none;">
      <div class="modal-overlay" id="modal-overlay"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h2>Settings</h2>
          <button id="close-modal-btn" class="btn-icon">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="settings-api-url">API URL</label>
            <input
              type="text"
              id="settings-api-url"
              placeholder="https://api.isekai.example.com"
              autocomplete="off"
            />
          </div>
          <div class="form-group">
            <label for="settings-api-key">API Key</label>
            <input
              type="password"
              id="settings-api-key"
              placeholder="isk_..."
              autocomplete="off"
            />
          </div>
          <div class="form-group">
            <label for="settings-retry-attempts">Retry Attempts (1-20)</label>
            <input
              type="number"
              id="settings-retry-attempts"
              placeholder="10"
              min="1"
              max="20"
              autocomplete="off"
            />
          </div>
          <div class="form-group">
            <label for="settings-max-retry-delay">Max Retry Delay (seconds)</label>
            <input
              type="number"
              id="settings-max-retry-delay"
              placeholder="30"
              min="5"
              max="120"
              step="5"
              autocomplete="off"
            />
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-settings-btn" class="btn-secondary btn-small">
            Cancel
          </button>
          <button id="save-settings-btn" class="btn-primary btn-small">
            Save Settings
          </button>
        </div>
      </div>
    </div>

    <script type="module" src="./console.ts"></script>
  </body>
</html>
